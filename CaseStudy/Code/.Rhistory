l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
s = as.data.frame(subset(REAL_TEST, select = -c(l,r) ))
REAL_TEST <- read_csv(paste(root_path,"REAL_DATA.csv",sep=""))
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
kk <- REAL_TEST$des
par(mfrow=c(3,3))
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u4f18\u5316\u7b97\u6cd5',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:Optimization',xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl("lstm",kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:LSTM",xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u534f\u540c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:Collaborative Filtering",xlab="Posted Salary",)
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('excel',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:EXCEL',xlab='Posted Salary',lty=2)
plot(EMICM(part1),new=FALSE,type='gw')
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u6574\u7406',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Preparation',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u7edf\u8ba1',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Summary',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5f85\u9047',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Firm',xlab='Posted Salary',density=10)
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u4f5c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Job',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u5177',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Tool',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
## Including Packages
library(readr)
library(Icens)
library(interval)
library(MASS)
library(dplyr)
library(energy)
root_path = paste(dirname(getwd()),"/Data/",sep="")
## Loading Data
dt <- read.csv(paste(root_path,"WordMatrix_Filter.csv",sep=""))
REAL_TEST = subset(dt, select = -c(X1) )
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
s = as.data.frame(subset(REAL_TEST, select = -c(l,r) ))
## Data Visulization (Figure 3)
REAL_TEST <- read_csv(paste(root_path,"REAL_DATA.csv",sep=""))
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
kk <- REAL_TEST$des
par(mfrow=c(3,3))
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u4f18\u5316\u7b97\u6cd5',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:Optimization',xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl("lstm",kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:LSTM",xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u534f\u540c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:Collaborative Filtering",xlab="Posted Salary",)
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('excel',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:EXCEL',xlab='Posted Salary',lty=2)
plot(EMICM(part1),new=FALSE,type='gw')
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u6574\u7406',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Preparation',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u7edf\u8ba1',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Summary',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5f85\u9047',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Firm',xlab='Posted Salary',density=10)
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u4f5c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Job',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u5177',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Tool',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(Icens)
library(interval)
library(MASS)
library(dplyr)
library(energy)
root_path = paste(dirname(getwd()),"/Data/",sep="")
dt <- read.csv(paste(root_path,"WordMatrix_Filter.csv",sep=""))
REAL_TEST = subset(dt, select = -c(X1) )
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
s = as.data.frame(subset(REAL_TEST, select = -c(l,r) ))
REAL_TEST <- read_csv(paste(root_path,"REAL_DATA.csv",sep=""))
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
kk <- REAL_TEST$des
par(mfrow=c(3,3))
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u4f18\u5316\u7b97\u6cd5',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:Optimization',xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl("lstm",kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:LSTM",xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u534f\u540c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:Collaborative Filtering",xlab="Posted Salary",)
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('excel',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:EXCEL',xlab='Posted Salary',lty=2)
plot(EMICM(part1),new=FALSE,type='gw')
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u6574\u7406',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Preparation',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u7edf\u8ba1',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Summary',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5f85\u9047',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Firm',xlab='Posted Salary',density=10)
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u4f5c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Job',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u5177',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Tool',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
## Including Packages
library(readr)
library(Icens)
library(interval)
library(MASS)
library(dplyr)
library(energy)
root_path = paste(dirname(getwd()),"/Data/",sep="")
## Loading Data
dt <- read.csv(paste(root_path,"WordMatrix_Filter.csv",sep=""))
REAL_TEST = subset(dt, select = -c(X1) )
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
s = as.data.frame(subset(REAL_TEST, select = -c(l,r) ))
## Data Visulization (Figure 3)
REAL_TEST <- read_csv(paste(root_path,"REAL_DATA.csv",sep=""))
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
kk <- REAL_TEST$des
par(mfrow=c(3,3))
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u4f18\u5316\u7b97\u6cd5',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:Optimization',xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl("lstm",kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:LSTM",xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u534f\u540c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:Collaborative Filtering",xlab="Posted Salary",)
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('excel',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:EXCEL',xlab='Posted Salary',lty=2)
plot(EMICM(part1),new=FALSE,type='gw')
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u6574\u7406',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Preparation',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u7edf\u8ba1',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Summary',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5f85\u9047',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Firm',xlab='Posted Salary',density=10)
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u4f5c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Job',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u5177',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Tool',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
## ADD-SIS Code
intervals <- initcomputeMLE(l,r)
max_tmp <- max(intervals$intmap[2,])
min_tmp <- min(intervals$intmap[1,])
if (is.finite(max_tmp)) {end <- max_tmp}
if (is.infinite(max_tmp)) {end <-max(intervals$intmap[1,])+100 }
if (is.finite(min_tmp)) {start <- min_tmp}
if (is.infinite(min_tmp)) {start <-min(intervals$intmap[2,])-100 }
X1<-c(as.integer(start/100):as.integer(end/100))
X2<-X1+1
basis<- data.frame(x1=100*X1,x2=100*X2)
int_split <- function(i,df){
start <- as.numeric(df[i,][1])/100
end <- as.numeric(df[i,][2])/100
difs <- end-start-1
x1 <- 100*(start+c(0:difs))
x2 <- 100*(start+1+c(0:difs))
x3 <- as.numeric(rep(df[i,][3]/(as.numeric(difs+1)),difs+1))
return (data.frame(x1=x1,x2=x2,x3=x3))
}
screen_add <- function(no,s=s) {
#word1 <- sapply(c(1:length(sub)[1]),function(i) grepl(dict[no],kk[i]))
x1 <- s[,no]
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==TRUE,c('l','r')]
part2 = every[every$x==FALSE,c('l','r')]
a <- initcomputeMLE(part1$l,part1$r)
b <- initcomputeMLE(part2$l,part2$r)
df1 <- data.frame(cbind(t(a$intmap),a$pf))
df2 <- data.frame(cbind(t(b$intmap),b$pf))
if (length(a$pf)==1){
if (max(df2$X2)>1) {kk2 = lapply(c(1:dim(df2)[1]),int_split,df=df2)
pp2 = bind_rows(kk2)}
if (max(df2$X2)==1) {ind_start <- (df2$X1/100)[1]
ind_end<- (df2$X1/100)[2]
pp2 <- data.frame(x1=100*c(ind_start:(ind_end-1)),
x2=100*c((ind_start+1):(ind_end)),
x3=rep(1/(end-start),as.numeric(ind_end-ind_start)))
}
tmp = merge(pp2,basis,all.y = TRUE)
tmp[is.na(tmp$x3),c('x3')]<-0
score_ = sum(100 * (cumsum(tmp$x3)))
}
else {
kk1 = lapply(c(1:dim(df1)[1]),int_split,df=df1)
pp1 = bind_rows(kk1)
if (max(df2$X2)>1) {kk2 = lapply(c(1:dim(df2)[1]),int_split,df=df2)
pp2 = bind_rows(kk2)}
if (max(df2$X2)==1) {ind_start <- (df2$X1/100)[1]
ind_end<- (df2$X1/100)[2]
pp2 <- data.frame(x1=100*c(ind_start:(ind_end-1)),
x2=100*c((ind_start+1):(ind_end)),
x3=rep(1/(end-start),as.numeric(ind_end-ind_start)))
}
a1 = merge(pp1,basis,all.y = TRUE)
a2 = merge(pp2,basis,all.y = TRUE)
tmp <- merge(a1,a2,by='x1')
tmp[is.na(tmp$x3.x),c('x3.x')]<-0
tmp[is.na(tmp$x3.y),c('x3.y')]<-0
score_ = sum(100 * abs(cumsum(tmp$x3.x)-cumsum(tmp$x3.y)))}
return(score_)
}
## Screening (Time Column in Table 4)
a = Sys.time()
score <- sapply(c(1:as.numeric(dim(s)[2])),screen_add,s=s)
b = Sys.time()
print ("ADD-SIS")
print (b-a)
res1 <- data.frame(screen=score)
three <- 2/3 * l + 1/3*r
mid <- 0.5*(l+r)
six <- 1/3 * l + 2/3*r
screen_ks<- function(i,y,s)
{every = data.frame(cbind(y,s[,i]))
part1 = every[every$V2==0,c('y')]
part2 = every[every$V2==1,c('y')]
return (as.numeric(ks.test(part1,part2)$statistic))
}
screen_dc <- function(i,y,s)
{return (dcor(y,s[,i]))}
Fk<-function(X0,x) {
Fk=c()
for (i in 1:length(x))
{ Fk[i]=sum(X0<=x[i])/length(X0) }
return(Fk)
}
Fkr<-function(X0,Y,yr,x) {
Fkr=c()
ind_yr=(Y==yr)
for (i in 1:length(x))
{ Fkr[i]=sum((X0<=x[i])*ind_yr)/sum(ind_yr) }
return(Fkr)
}
MV<-function(Xk,Y) {
Fk0 <- Fk(Xk,Xk)
Yr <- unique(Y)
MVr <- c()
for (r in 1:length(Yr)) {
MVr[r] <- (sum(Y==Yr[r])/length(Y))*mean((Fkr(Xk,Y,Yr[r],Xk)-Fk0)^2)
}
MV <- sum(MVr)
return(MV)
}
screen_mv <- function(i,s,y)
{return (abs(MV(Y=s[,i],Xk=y)))}
a = Sys.time()
score2 = sapply(c(1:as.numeric(dim(s)[2])),screen_ks,y=mid,s=s)
res2 <- data.frame(screen=score2)
b = Sys.time()
print ("KF-M2")
print (b-a)
a = Sys.time()
score3 = sapply(c(1:as.numeric(dim(s)[2])),screen_dc,y=mid,s=s)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(Icens)
library(interval)
library(MASS)
library(dplyr)
library(energy)
root_path = paste(dirname(getwd()),"/Data/",sep="")
dt <- read.csv(paste(root_path,"WordMatrix_Filter.csv",sep=""))
REAL_TEST = subset(dt, select = -c(X1) )
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
s = as.data.frame(subset(REAL_TEST, select = -c(l,r) ))
REAL_TEST <- read_csv(paste(root_path,"REAL_DATA.csv",sep=""))
l = as.numeric(REAL_TEST$l)
r =  as.numeric(REAL_TEST$r)
kk <- REAL_TEST$des
par(mfrow=c(3,3))
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u4f18\u5316\u7b97\u6cd5',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:Optimization',xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl("lstm",kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:LSTM",xlab="Posted Salary")
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u534f\u540c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part2),type='gw',main="Word:Collaborative Filtering",xlab="Posted Salary",)
plot(EMICM(part1),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('excel',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part2),type='gw',main='Word:EXCEL',xlab='Posted Salary',lty=2)
plot(EMICM(part1),new=FALSE,type='gw')
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u6574\u7406',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Preparation',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u6570\u636e\u7edf\u8ba1',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==1,c('l','r')]
part2 = every[every$x==0,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Data Summary',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5f85\u9047',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Firm',xlab='Posted Salary',density=10)
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u4f5c',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Job',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
word1 <- sapply(c(1:dim(REAL_TEST)[1]),function(i) grepl('\u5de5\u5177',kk[i]))
x1 <- word1
every = data.frame(l=l,r=r,x=x1)
part1 = every[every$x==0,c('l','r')]
part2 = every[every$x==1,c('l','r')]
plot(EMICM(part1),type='gw',main='Word:Tool',xlab='Posted Salary')
plot(EMICM(part2),new=FALSE,type='gw',lty=2)
